# Система анализа международных переводов

## Описание проекта
Система предназначена для анализа международных банковских транзакций. Она загружает данные из CSV-файлов (транзакции и справочник стран), обрабатывает их с помощью ETL-процессов, определяет уровень риска транзакций на основе суммы перевода и статуса страны, а затем визуализирует результаты на дашборде.

## Функциональность
- **Загрузка данных**: CSV-файлы с транзакциями и странами загружаются в слой сырых данных (Raw).
- **Обработка данных**: Данные преобразуются и переносятся в слой ядра (Core) хранилища данных (DWH).
- **Определение риска**: На основе бизнес-правил система определяет уровень риска транзакций:
  - **Низкий риск**: Сумма < 20 000 рублей и страна с низким риском.
  - **Средний риск**: Сумма от 20 000 до 50 000 рублей и страна с низким/неподозрительным статусом.
  - **Высокий риск**: Сумма > 50 000 рублей или подозрительная страна.
- **Визуализация**: Дашборд отображает гистограмму переводов по странам и таблицу с детализацией транзакций. Доступны фильтры по риску, стране и сумме.

## Структура данных
### Слой Raw
- **raw.transfers**: Содержит исходные данные о транзакциях (ID, сумма, дата, страна, клиент, номер счета).
- **raw.countries**: Содержит справочник стран (ID, название, статус).

### Слой Core
- **core.transfers**: Очищенные данные о транзакциях.
- **core.countries**: Справочник стран.

### Слой Mart
- **mart.transfers**: Данные с рассчитанным уровнем риска транзакций.

## Бизнес-правила
1. Транзакции до 20 000 рублей — низкий риск.
2. Транзакции от 20 000 до 50 000 рублей — средний риск (если страна не подозрительная).
3. Транзакции свыше 50 000 рублей — высокий риск.
4. Уровень риска зависит от статуса страны.

## Скриншот дашборда

<img width="1279" alt="image" src="https://github.com/user-attachments/assets/8a2ede6d-de21-420f-ba93-cb79f3b0fe91" />

## Пример SQL-запросов для определения риска
```sql
-- Для транзакций > 50 000
CASE
  WHEN t.Amount > 50000 THEN 'высокий риск'
END

-- Для транзакций от 20 000 до 50 000
CASE
  WHEN t.Amount BETWEEN 20000 AND 50000 THEN
    CASE
      WHEN c.Status = 'СНГ (не подозрительная)' THEN 'средний риск'
      WHEN c.Status = 'Низкий риск' THEN 'средний риск'
      ELSE 'высокий риск'
    END
END

-- Для транзакций < 20 000
CASE
  WHEN t.Amount < 20000 THEN
    CASE
      WHEN c.Status = 'СНГ (не подозрительная)' THEN 'низкий риск'
      WHEN c.Status = 'Низкий риск' THEN 'низкий риск'
      ELSE 'высокий риск'
    END
END



